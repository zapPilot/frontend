#!/usr/bin/env sh
set -eu

# Pre-commit quality gates (strict local safety)
# Block commits unless static analysis and comprehensive tests pass.

printf '%s\n' "ğŸ” Running pre-commit quality gates..."

# Phase 1: Staged file formatting/linting
printf '\nğŸ“‹ Phase 1: Staged Formatting & Linting\n'
npx lint-staged

# Phase 2: Fast static analysis
printf '\nğŸ“‹ Phase 2: Fast Static Analysis\n'
npm run type-check
npm run deadcode:check
npm run dup:all

# Phase 3: Comprehensive tests
printf '\nğŸ§ª Phase 3: Comprehensive Test Suite\n'
npm run test:safeall

printf '\nâœ… Pre-commit quality gates passed!\n'
