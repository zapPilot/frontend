# Development Guide

## üõ†Ô∏è Complete Setup Summary

This project includes a comprehensive development toolchain with automated code quality, formatting,
and CI/CD pipelines.

## üì¶ Tools Configured

### Code Quality & Formatting

- **ESLint** - Next.js 15 compatible configuration with TypeScript rules
- **Prettier** - Consistent code formatting with project-specific rules
- **TypeScript** - Strict type checking with comprehensive compiler options
- **EditorConfig** - Consistent coding standards across editors

### Git Hooks & Automation

- **Husky** - Git hooks management
- **lint-staged** - Run linters on staged files only
- **Pre-commit hooks** - Automatic formatting and linting before commits

### CI/CD Pipelines

- **Main CI Pipeline** (`ci.yml`) - Complete build, test, and deployment workflow
- **Code Quality Pipeline** (`code-quality.yml`) - Dedicated linting and formatting checks
- **Dependency Review** (`dependency-review.yml`) - Security and license compliance

### Development Environment

- **VS Code Settings** - Optimized workspace configuration
- **Extension Recommendations** - Essential extensions for productivity
- **PWA Configuration** - Progressive Web App with manifest and service worker

## üöÄ Available Scripts

```bash
# Development
npm run dev              # Start development server with Turbopack
npm run build           # Production build
npm run start           # Start production server

# Code Quality
npm run lint            # Run ESLint
npm run lint:fix        # Auto-fix ESLint issues
npm run format          # Format all files with Prettier
npm run format:check    # Check if files are formatted
npm run type-check      # TypeScript type checking
npm run deadcode        # Combined Knip + ts-prune sweep for unused files/exports

# Testing
npm test               # Run tests (configure as needed)
```

### Dead Code Detection

Run `npm run deadcode` to execute the original Knip scan **and** a TypeScript export sweep (ts-prune with `tsconfig.tsprune.json`). Knip still covers unused files/dependencies, while ts-prune flags orphaned exports hiding behind barrel re-exports (e.g., `src/components/wallet/metrics/YieldMetric.tsx`). CI variants (`deadcode:ci`, `deadcode:check`, etc.) now include both passes, so failures will surface whenever either tool detects issues.

## üîÑ Workflow

### Local Development

1. **Start development**: `npm run dev`
2. **Make changes** - VS Code will auto-format on save
3. **Commit** - Pre-commit hooks automatically run:
   - Prettier formatting
   - ESLint fixing
   - Type checking (in CI)

### Quality Checks

All checks run automatically in CI, but you can run them locally:

```bash
# Full quality check
npm run format:check && npm run lint && npm run type-check
```

### CI/CD Pipeline

On every push/PR to main/develop:

1. **Code Quality Checks**
   - Prettier formatting verification
   - ESLint analysis with annotations
   - TypeScript type checking
   - Automatic PR comments on failures

2. **Build & Test**
   - Next.js production build
   - Test execution
   - Artifact generation

3. **Security & Dependencies**
   - npm audit for vulnerabilities
   - Dependency license review
   - Automated security scanning

4. **Deployment** (on main branch)
   - Preview deployment (PRs)
   - Production deployment (main)

## üìù Configuration Files

### Core Configuration

- `next.config.ts` - Next.js and PWA configuration
- `tsconfig.json` - TypeScript strict configuration
- `eslint.config.mjs` - ESLint rules for Next.js 15
- `prettier.config.json` - Prettier formatting rules
- `tailwind.config.js` - Tailwind CSS configuration

### Development Tools

- `.vscode/settings.json` - VS Code workspace settings
- `.vscode/extensions.json` - Recommended extensions
- `.editorconfig` - Cross-editor configuration
- `.husky/pre-commit` - Git pre-commit hook

### CI/CD Workflows

- `.github/workflows/ci.yml` - Main CI/CD pipeline
- `.github/workflows/code-quality.yml` - Code quality checks
- `.github/workflows/dependency-review.yml` - Security scanning

### PWA Configuration

- `public/manifest.json` - PWA manifest
- Service worker automatically generated by next-pwa

## üéØ Best Practices

### Code Organization

```
src/
‚îú‚îÄ‚îÄ app/                 # Next.js App Router
‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx      # Root layout
‚îÇ   ‚îú‚îÄ‚îÄ page.tsx        # Home page
‚îÇ   ‚îî‚îÄ‚îÄ globals.css     # Global styles
‚îú‚îÄ‚îÄ components/          # Reusable components
‚îú‚îÄ‚îÄ hooks/              # Custom hooks
‚îú‚îÄ‚îÄ lib/                # Utilities
‚îî‚îÄ‚îÄ types/              # Type definitions
```

### Commit Convention

Follow conventional commits:

```
feat(dashboard): add portfolio metrics
fix(auth): resolve wallet connection
docs(readme): update installation guide
style(ui): improve button styling
refactor(api): optimize data fetching
test(utils): add utility function tests
chore(deps): update dependencies
```

### Component Guidelines

- Use TypeScript interfaces for props
- Implement proper accessibility
- Follow Tailwind CSS patterns
- Use Framer Motion for animations
- Ensure mobile responsiveness

### Performance Optimization

- Next.js App Router for optimal loading
- Image optimization with next/image
- PWA features for mobile performance
- Code splitting and lazy loading
- Turbopack for fast development builds

## üîß Troubleshooting

### Common Issues

**ESLint errors after dependency updates**

```bash
npm run lint:fix
```

**TypeScript errors**

```bash
npm run type-check
# Fix type issues manually
```

**Formatting issues**

```bash
npm run format
```

**Pre-commit hook failures**

```bash
# Fix issues and re-commit
npm run format && npm run lint:fix
git add .
git commit -m "fix: resolve linting issues"
```

**Build failures**

```bash
# Check for type errors
npm run type-check
# Check for linting issues
npm run lint
# Try clean build
rm -rf .next
npm run build
```

### VS Code Setup

1. Install recommended extensions
2. Reload VS Code
3. Enable format on save (already configured)
4. Auto-import organization (already configured)

## üìä CI/CD Status Badges

Add these to your README:

```markdown
![CI](https://github.com/your-org/zap-pilot/workflows/CI%2FCD%20Pipeline/badge.svg)
![Code Quality](https://github.com/your-org/zap-pilot/workflows/Code%20Quality/badge.svg)
```

## üîí Security

- Automated dependency scanning
- License compliance checking
- npm audit in CI pipeline
- No secrets in code (enforced by linting)
- Secure headers in production builds

This setup ensures consistent code quality, automated testing, and smooth deployment workflows for
the Zap Pilot project.
